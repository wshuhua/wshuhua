(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{508:function(t,s,a){"use strict";a.r(s);var n=a(28),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"_01-react中的事件处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_01-react中的事件处理"}},[t._v("#")]),t._v(" 01. react中的事件处理")]),t._v(" "),a("p",[t._v("在语法上：")]),t._v(" "),a("ul",[a("li",[t._v("React 事件的命名采用小驼峰式（camelCase），而不是纯小写。")]),t._v(" "),a("li",[t._v("使用 JSX 语法时需要传入一个函数作为事件处理函数，而不是一个字符串。")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('传统：\n<button onclick="activateLasers()">\n  Activate Lasers\n</button>\nReact 中\n <button onClick={activateLasers}>\n  Activate Lasers\n</button>\n')])])]),a("ul",[a("li",[t._v("阻止默认事件执行：不能return false 来阻止默认行为，必须通过"),a("code",[t._v("preventDefault")]),t._v("来阻止")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('传统：\n<form onsubmit="console.log(\'You clicked submit.\'); return false">\n  <button type="submit">Submit</button>\n</form>\n\nreact 中\nfunction Form() {\n  function handleSubmit(e) {\n    // e 是一个合成事件\n    e.preventDefault();\n    console.log(\'You clicked submit.\');\n  }\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <button type="submit">Submit</button>\n    </form>\n  );\n}\n')])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("通过 在回调中使用箭头函数绑定this，此语法问题在于每次渲染组件时都会创建不同的回调函数。如果该回调函数作为 prop 传入子组件时，这些组件可能会进行额外的重新渲染")]),t._v(" "),a("p",[t._v("<button onClick={() => this.handleClick()}>Click me")]),t._v(" "),a("p",[t._v("<button onClick={this.deleteRow.bind(this, id)}>Delete Row")])]),t._v(" "),a("h3",{attrs:{id:"_02-合成事件的实现机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_02-合成事件的实现机制"}},[t._v("#")]),t._v(" 02. 合成事件的实现机制")]),t._v(" "),a("p",[t._v("在react底层，主要对合成事件做了两件事：事件委派 和 自动绑定")]),t._v(" "),a("h3",{attrs:{id:"事件委派"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件委派"}},[t._v("#")]),t._v(" 事件委派")]),t._v(" "),a("p",[t._v("react的事件代理机制，不会把事件处理函数直接绑定到真实的节点上，而是把所有的事件绑定到结构的最外层，使用一个统一的事件监听器。\n当组件挂载或者卸载时，只是在这个统一的事件监听器上插入或者删除一些对象；当事件发生时，首先被这个统一的事件监听器处理，然后再映射里找到真正的事件处理函数并调用。 这样做简化了事件梳理和回收机制。")]),t._v(" "),a("h3",{attrs:{id:"自动绑定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动绑定"}},[t._v("#")]),t._v(" 自动绑定")]),t._v(" "),a("p",[t._v("在react组件中，每个方法的上下文都会指向该组件的实例，即自动绑定"),a("code",[t._v("this")]),t._v("为当前组件。而且React还会对这种引用进行缓存，以达到CPU和内存的最优化。")]),t._v(" "),a("p",[t._v("在使用ES6 classes 或者纯函数的时候，这种绑定就不复存在了。需要我们手动绑定this")]),t._v(" "),a("ul",[a("li",[t._v("bind方法")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Home")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'del'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"home"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("span onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("span"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("如果方法只绑定，不传参，"),a("code",[t._v("stage0")]),t._v(" 草案提供给了 - 双冒号语法。 其作用与"),a("code",[t._v("this.del.bind(this)")]),t._v("一致。babel已经实现了该提案。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("span onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("del"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("span"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])]),t._v(" "),a("ul",[a("li",[t._v("构造器内声明\n在组件的构造函数内完成了this的绑定，这种绑定方法的好处在于仅需要进行一次绑定，而不需要每次调用事件监听器时去执行绑定操作。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("del "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("箭头函数\n箭头函数不仅仅是函数的语法糖，它还自动绑定了定义此函数作用域的this, 因此我们不需要对它进行bind操作。\n写法一：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("del")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'del'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"home"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("span onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("del"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11111")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("span"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("写法二：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div className"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"home"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("span onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("del")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11111")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("span"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_03-合成事件与原生事件混用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_03-合成事件与原生事件混用"}},[t._v("#")]),t._v(" 03. 合成事件与原生事件混用")]),t._v(" "),a("p",[t._v("应该尽量避免在React中混用合成事件和原生DOM事件。另外，用reactEvent.nativeEvent.stopPropagation() 来阻止冒泡时不行的。阻止React事件冒泡的行为只能用于React合成系统中，且没办法阻止原生事件的冒泡。反之，在原生事件中的阻止冒泡行为，可以阻止React合成事件的传播。")]),t._v(" "),a("p",[t._v("React的合成事件系统只是原生DOM事件系统的一个子集。它仅仅实现了DOM Level3的事件接口，并且统一了浏览器的兼容性问题。 有些事件React没有实现，或者说受限制，没有办法去实现。比如window的resize事件。")]),t._v(" "),a("p",[t._v("对于无法使用React的合成事件的场景，我们需要使用原生事件来完成。")]),t._v(" "),a("h3",{attrs:{id:"_04-合成事件-js原生事件对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_04-合成事件-js原生事件对比"}},[t._v("#")]),t._v(" 04. 合成事件/js原生事件对比")]),t._v(" "),a("p",[t._v("主要从四个方面对比")]),t._v(" "),a("ul",[a("li",[t._v("事件传播与阻止事件传播\n浏览器原生DOM事件的传播可以分为3个阶段："),a("code",[t._v("事件捕获")]),t._v("，"),a("code",[t._v("目标对象本身的事件处理程序调用")]),t._v(","),a("code",[t._v("事件冒泡")]),t._v("。")])]),t._v(" "),a("ol",[a("li",[t._v("事件捕获会优先调用结构树最外层的元素上绑定的事件监听器")]),t._v(" "),a("li",[t._v("然后依次向内调用，一直调用到目标元素上的事件监听器为止。（可以在e.addEventListener()的第三个参数设置为true时，为元素e注册捕获事件处理程序，并且在事件传播的第一个阶段调用）")])]),t._v(" "),a("ul",[a("li",[t._v("事件冒泡与事件捕获相反，从目标元素向外传播，由内向外直到最外层。")])]),t._v(" "),a("p",[t._v("阻止原生事件传播需要使用e.stopPropagation()，不过对于该方法的浏览器，需要使用.cancalBubble = true来阻止。在react 合成事件中，只需要使用stopProgapation()")]),t._v(" "),a("ul",[a("li",[t._v("事件类型\nReact 合成事件的事件类型是js原生事件类型的一个子集。")]),t._v(" "),a("li",[t._v("事件绑定方式\n原生绑定方式有多种，而React的合成事件的绑定方式简单")]),t._v(" "),a("li",[t._v("事件对象\n原生DOM事件对象在W3C标准和IE标准下存在差异。在低版本的IE浏览器中，使用window.event 来获取事件对象。而在React合成事件系统中，不存在这种兼容性问题，在事件处理函数中可以得到一恶搞合成事件对象。")])]),t._v(" "),a("h3",{attrs:{id:"_02-react-事件机制特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_02-react-事件机制特点"}},[t._v("#")]),t._v(" 02. react 事件机制特点")]),t._v(" "),a("p",[t._v("由于fiber机制的特点，生成一个fiber节点时，它对应的dom节点有可能还未挂载，onClick这样的事件处理函数作为fiber节点的prop，不能直接被绑定到真实的DOM节点上。所以React提供了一种“顶层注册，事件收集，统一触发”的事件机制。利用fiber树的层级关系来生成事件执行路径，进而模拟事件捕获和冒泡")]),t._v(" "),a("ul",[a("li",[t._v("顶层注册： 在root元素上绑定一个统一的事件处理函数")]),t._v(" "),a("li",[t._v("事件收集：事件触发时（实际上是root上的事件处理函数被执行），构造合成事件对象，按照冒泡或捕获的路径去组件中收集真正的事件处理函数")]),t._v(" "),a("li",[t._v("统一触发： 在收集过程之后，对所收集的事件逐一执行，并共享同一个合成事件对象。")])]),t._v(" "),a("h3",{attrs:{id:"_03-react事件注册机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_03-react事件注册机制"}},[t._v("#")]),t._v(" 03. react事件注册机制")]),t._v(" "),a("ul",[a("li",[t._v("事件注册 - 组件挂载阶段，根据组件内的声明的事件类型-onclick，onchange 等，给 root(17之前是添加到document) 上添加事件 -addEventListener，将事件绑定到root元素上")])]),t._v(" "),a("p",[t._v("事件监听器listener：是执行 "),a("code",[t._v("createEventListenerWrapperWithPriority")]),t._v("的调用结果，根据优先级和事件名的映射关系返回不同的事件。")]),t._v(" "),a("ul",[a("li",[t._v("事件存储 - 就是把 react 组件内的所有事件统一的存放到一个对象里，缓存起来，为了在触发事件的时候可以查找到对应的方法去执行。")])]),t._v(" "),a("h3",{attrs:{id:"_04-react事件合成机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_04-react事件合成机制"}},[t._v("#")]),t._v(" 04. react事件合成机制")]),t._v(" "),a("p",[t._v("合成事件对象： 经过React合成的SyntheticEvent对象")]),t._v(" "),a("ol",[a("li",[t._v("对原生事件的封装")]),t._v(" "),a("li",[t._v("对某些原生事件的升级和改造")]),t._v(" "),a("li",[t._v("不同浏览器事件兼容的处理")]),t._v(" "),a("li",[t._v("通过将事件 normalize 以让他们在不同浏览器中拥有一致的属性。")])]),t._v(" "),a("p",[t._v("如果一个节点上同时绑定了合成和原生事件，那么禁止冒泡后执行关系是怎样的？")]),t._v(" "),a("p",[t._v("因为合成事件的触发是基于浏览器的事件机制来实现的，通过冒泡机制冒泡到最顶层元素，然后再由 dispatchEvent统一去处理。")]),t._v(" "),a("ul",[a("li",[t._v("原生事件阻止冒泡肯定会阻止合成事件的触发。")]),t._v(" "),a("li",[t._v("合成事件的阻止冒泡不会影响原生事件。\n浏览器事件的执行需要经过三个阶段，捕获阶段-目标元素阶段-冒泡阶段。")])]),t._v(" "),a("p",[t._v("节点上的原生事件的执行是在目标阶段，合成事件的执行是在冒泡阶段，所以原生事件会先合成事件执行，然后再往父节点冒泡。")]),t._v(" "),a("p",[t._v("事件执行路径：当事件对象合成完毕，将事件收集到事件执行路径上，从触发事件的元素开始，依据fiber树的层级结构向上查找，累加上级元素中所有相同类型的事件，最终形成一个具有所有相同类型事件的数组。React自己模拟了一套事件捕获与冒泡的机制。")]),t._v(" "),a("p",[t._v("总结：\n由于fiber树的特点，一个组件如果含有事件的prop，那么将会在对应fiber节点的commit阶段绑定一个事件监听到root上，这个事件监听是持有优先级的，将它和优先级机制联系了起来，可以把合成事件机制当作一个协调者，负责去协调合成事件对象、收集事件、触发真正的事件处理函数这三个过程")])])}),[],!1,null,null,null);s.default=e.exports}}]);